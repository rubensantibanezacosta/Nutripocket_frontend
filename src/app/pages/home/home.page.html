<ion-header [translucent]="true">
  <ion-toolbar color="warning">
    <ion-buttons slot="start">
      <ion-menu-button side="start" color="light"></ion-menu-button>
    </ion-buttons>
    <ion-title color="light" class="text-shadow">
      <!-- <ion-icon name="calendar-number-outline" class="text-shadow" size="medium" color="dark"></ion-icon> --> 
      <span class="calendar-icon">
        <img src="{{calendarEmptyIcon}}" alt="">
      </span>
      Diario
    </ion-title>
    
  </ion-toolbar>
</ion-header>


<ion-content [fullscreen]="false">
  <!-- Days -->
  <ion-item class="date-selector" collapse="fade" lines="none">
    <ion-button (click)="previousDate()" fill="default">
      <ion-icon size="large" name="chevron-back-outline" color="warning"></ion-icon>
    </ion-button>
    <ion-title size="small">{{formatDate(date)}}</ion-title>
    <ion-button (click)="nextDate()" fill="default">
      <ion-icon size="large" name="chevron-forward-outline" color="warning"></ion-icon>
    </ion-button>
  </ion-item>

  

  
  <ion-list *ngFor="let dayfood of dayFoods; let i=index;">
    <!-- Dishes -->
    <ion-accordion-group value="foods">

        <ion-item  class="card-title-item" lines="none" class="fooday" shape="round">
          <ion-title color="warning">{{dayfood}}</ion-title>

          <ion-buttons>
            <ion-button fill="default" color="secondary" size="medium">
              <ion-icon slot="end" color="warning" name="add-outline" size="large"></ion-icon>
            </ion-button>

            <ion-button size="small" fill="default" slot="end"
              *ngIf="currentDay!=undefined && currentDay.dishes.length>0 && currentDay.dishes[i]!=undefined"
              (click)="recalculateDish(currentDay.dishes[i].id, i+1)">
              <ion-icon size="large" name="repeat-outline" color="warning"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-item>

        <ion-accordion value="{{dayfood}}">

        <ion-item slot="header" class="card-title-item"
          *ngIf="currentDay!=undefined && currentDay.dishes.length>0 && currentDay.dishes[i]!=undefined">
          <ion-label>
            <p class="totals-list">
              <span>{{calculateDishCalories(currentDay.dishes[i])}}Kcal</span>
              <span>P: {{calculateDishProtein(currentDay.dishes[i])}}g</span>
              <span>C: {{calculateDishCarbs(currentDay.dishes[i])}}g</span>
              <span>G: {{calculateDishFat(currentDay.dishes[i])}}g</span>
            </p>
          </ion-label>
          <ion-button slot="end" fill="default">
            <ion-icon name="chevron-down-outline" color="medium"></ion-icon>
          </ion-button>
        </ion-item>

        
        <ion-item  class="card-title-item" *ngIf="currentDay==undefined">
          <ion-label>
            <p class="totals-list">
              <span>0Kcal</span>
              <span>P: 0g</span>
              <span>C: 0g</span>
              <span>G: 0g</span>
            </p>
          </ion-label>

        </ion-item>
        <!-- Item -->
        <!-- Multi-line sliding item with icon options on both sides -->
        
        <ion-list slot="content"
          *ngIf="currentDay!=undefined && currentDay.dishes.length>0 && currentDay.dishes[i]!=undefined"
          class="food-list">
          <ion-item-sliding class="ion-activatable ripple-parent" *ngFor="let item of currentDay.dishes[i].items">

            <ion-item>
              <ion-label>
                <h3>{{item.food.nombre}}</h3>
                <p>{{round(item.dosex*item.food.doseg/100*item.food.calories100g)}} Kcal</p>
              </ion-label>
              <ion-label slot="end" class="food-quatity">{{item.dosex*item.food.doseg}}g</ion-label>

              <ion-ripple-effect>
              </ion-ripple-effect>
            </ion-item>

            <ion-item-options side="end">
              <ion-item-option color="danger"  (click)="deleteItem(item.id, $event.target)">
                <ion-icon slot="icon-only" name="trash">
                </ion-icon>
              </ion-item-option>
            </ion-item-options>
          </ion-item-sliding>


          <ion-item lines="none">
            <ion-button fill="default" color="secondary" size="medium">
              <ion-label color="warning">Añadir alimento </ion-label>
              <ion-icon slot="end" color="warning" name="add-outline"></ion-icon>
            </ion-button>
            <!-- <ion-checkbox color="light" slot="end"></ion-checkbox> -->
          </ion-item>
        </ion-list>
      </ion-accordion>
    </ion-accordion-group>
  </ion-list>

  <ion-item class="card-title-item" lines="none" class="fooday" shape="round">
    <ion-title color="warning">Resúmen</ion-title>
  </ion-item>

  <ion-list class="resumen">
  <ion-item lines="none">


    <ion-label>
      <ion-grid>
        <ion-row>
          <ion-col size="6">
            <ion-label>
              <p>Calorias</p>
            </ion-label>
          </ion-col>
          <ion-col size="6">
            <p class="totals-day-numbers">
              {{round(daytotals.calories) || 0}} / {{round(evolution.calreq) || 0}} Kcal</p>
          </ion-col>
        </ion-row>
        <ion-row>

          <ion-progress-bar
            *ngIf="daytotals.calories/evolution.calreq>=1.2 || daytotals.calories/evolution.calreq<=0.4"
            color="danger" value="{{daytotals.calories/evolution.calreq}}  ">
          </ion-progress-bar>

          <ion-progress-bar
            *ngIf="(daytotals.calories/evolution.calreq>0.4 &&  daytotals.calories/evolution.calreq<0.8) || (daytotals.calories/evolution.calreq>=1.1 &&  daytotals.calories/evolution.calreq<=1.2)"
            color="warning" value="{{daytotals.calories/evolution.calreq}}">
          </ion-progress-bar>

          <ion-progress-bar
            *ngIf="daytotals.calories/evolution.calreq<=1.1 && daytotals.calories/evolution.calreq>0.8"
            color="success" value="{{daytotals.calories/evolution.calreq}}">
          </ion-progress-bar>

        </ion-row>
      </ion-grid>
    </ion-label>
  </ion-item>

  <ion-item lines="none">
    <ion-label>
      <ion-grid>
        <ion-row>
          <ion-col size="6">
            <ion-label>
              <p>Proteinas</p>
            </ion-label>
          </ion-col>
          <ion-col size="6">
            <p class="totals-day-numbers">
              {{round(daytotals.protein) || 0}} / {{round(evolution.proteinreq) || 0}} g</p>
          </ion-col>
        </ion-row>
        <ion-row>

          <ion-progress-bar
            *ngIf="daytotals.protein/evolution.proteinreq>=1.2 || daytotals.protein/evolution.proteinreq<=0.4"
            color="danger" value="{{daytotals.protein/evolution.proteinreq}}">
          </ion-progress-bar>

          <ion-progress-bar
            *ngIf="(daytotals.protein/evolution.proteinreq>0.4 &&  daytotals.protein/evolution.proteinreq<0.8) || (daytotals.protein/evolution.proteinreq>=1.1 &&  daytotals.protein/evolution.proteinreq<=1.2)"
            color="warning" value="{{daytotals.protein/evolution.proteinreq}}">
          </ion-progress-bar>

          <ion-progress-bar
            *ngIf="daytotals.protein/evolution.proteinreq<=1.1 && daytotals.protein/evolution.proteinreq>0.8"
            color="success" value="{{daytotals.protein/evolution.proteinreq}}">
          </ion-progress-bar>

        </ion-row>
      </ion-grid>
    </ion-label>
  </ion-item>

  <ion-item lines="none">
    <ion-label>
      <ion-grid>
        <ion-row>
          <ion-col size="6">
            <ion-label>
              <p>Carbohidratos</p>
            </ion-label>
          </ion-col>
          <ion-col size="6">
            <p class="totals-day-numbers">
              {{round(daytotals.carbs) || 0}} / {{round(evolution.carbreq) || 0}} g</p>
          </ion-col>
        </ion-row>
        <ion-row>

          <ion-progress-bar *ngIf="daytotals.carbs/evolution.carbreq>=1.2 || daytotals.carbs/evolution.carbreq<=0.4"
            color="danger" value="{{daytotals.carbs/evolution.carbreq}}">
          </ion-progress-bar>

          <ion-progress-bar
            *ngIf="(daytotals.carbs/evolution.carbreq>0.4 &&  daytotals.carbs/evolution.carbreq<0.8) || (daytotals.carbs/evolution.carbreq>=1.1 &&  daytotals.carbs/evolution.carbreq<=1.2)"
            color="warning" value="{{daytotals.carbs/evolution.carbreq}}">
          </ion-progress-bar>

          <ion-progress-bar *ngIf="daytotals.carbs/evolution.carbreq<=1.1 && daytotals.carbs/evolution.carbreq>0.8"
            color="success" value="{{daytotals.carbs/evolution.carbreq}}">
          </ion-progress-bar>

        </ion-row>
      </ion-grid>
    </ion-label>
  </ion-item>


  <ion-item lines="none">
    <ion-label>
      <ion-grid>
        <ion-row>
          <ion-col size="6">
            <ion-label>
              <p>Grasas</p>
            </ion-label>
          </ion-col>
          <ion-col size="6">
            <p class="totals-day-numbers">
              {{round(daytotals.fat) || 0}} / {{round(evolution.fatreq) || 0}} g</p>
          </ion-col>
        </ion-row>
        <ion-row>

          <ion-progress-bar *ngIf="daytotals.fat/evolution.fatreq>=1.2 || daytotals.fat/evolution.fatreq<=0.4"
            color="danger" value="{{daytotals.fat/evolution.fatreq}}">
          </ion-progress-bar>

          <ion-progress-bar
            *ngIf="(daytotals.fat/evolution.fatreq>0.4 &&  daytotals.fat/evolution.fatreq<0.8) || (daytotals.fat/evolution.fatreq>=1.1 &&  daytotals.fat/evolution.fatreq<=1.2)"
            color="warning" value="{{daytotals.fat/evolution.fatreq}}">
          </ion-progress-bar>

          <ion-progress-bar *ngIf="daytotals.fat/evolution.fatreq<=1.1 && daytotals.fat/evolution.fatreq>0.8"
            color="success" value="{{daytotals.fat/evolution.fatreq}}">
          </ion-progress-bar>



        </ion-row>
      </ion-grid>
    </ion-label>
  </ion-item>

</ion-list>



</ion-content>